<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: monit
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_classes::monit";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (m)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">monit</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: monit</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd><span class='object_link'><a href="monit_3A_3Aparams.html" title="puppet_classes::monit::params (puppet_class)">monit::params</a></span></dd>
  </dl>
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/init.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    
<p>monit</p>

<p>This class is the responsible of installing and configuring the Monit
service. Almost all configuration options for <code>monitrc</code> are
exposed as class parameters.</p>

<p>In addition to Monit configuration options, this class accepts other
parameters:</p>
<ul><li>
<p><code>init_system</code>, to set globally the default init system for
<code>service</code> checks.</p>
</li><li>
<p><code>checks</code>, to provide checks from Hiera.</p>
</li></ul>

<p>Lastly, this class also configures a <code>system</code> check with sane
defaults. It can be disabled or tweaked to fit your needs. See the set of
parameters starting with <code>system_</code>.</p>

  </div>
</div>


<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>service_enable</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to enable the monit service.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>service_ensure</span>
      
      
        <span class='type'>(<tt>Enum[
    'running',
    'stopped'
    ]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;running&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Ensure status of the monit service.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>conf_file</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::conf_file</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the Monit main configuration file.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>conf_dir</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::conf_dir</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the Monit configuration directory (where checks are placed).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>conf_purge</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to purge checks not managed by Puppet.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>check_interval</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::check_interval</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Check services at given interval.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>check_start_delay</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::check_start_delay</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Delay the first check after Monit starts by this interval.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>logfile</span>
      
      
        <span class='type'>(<tt>Variant[
    Stdlib::Absolutepath,
    Pattern['^syslog( facility [_a-zA-Z0-9]+)?$']
    ]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::logfile</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to a logfile or syslog logging facility.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>idfile</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::idfile</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the Monit instance unique id file.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>statefile</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::statefile</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the persistent state file.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>eventqueue</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::eventqueue</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to enable the event queue.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>eventqueue_basedir</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;/var/monit&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the event queue directory.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>eventqueue_slots</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>100</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Size of the event queue.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mmonit_url</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Httpurl]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>M/Monit url.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mailserver</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>List of mail servers for alert delivery.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mailformat_from</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&quot;monit@${::fqdn}&quot;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Override FROM field of the alert mail format.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mailformat_replyto</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Override REPLYTO field of the alert mail format. NOTE: reply-to available
since Monit 5.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mailformat_subject</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Override SUBJECT field of the alert mail format.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>mailformat_message</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Override MESSAGE field of the alert mail format.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>alerts</span>
      
      
        <span class='type'>(<tt>Array[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Alert recipients. Alerts may be restricted on events by using a filter.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to enable the embedded webserver.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver_port</span>
      
      
        <span class='type'>(<tt>Integer[1024, 65535]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>2812</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Webserver port.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver_bind_address</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Webserver bind address.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver_ssl</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to enable SSL for the webserver.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver_pemfile</span>
      
      
        <span class='type'>(<tt>Optional[
    Stdlib::Absolutepath
    ]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Webserver SSL certificate file.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>httpserver_allow</span>
      
      
        <span class='type'>(<tt>Array[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[ &#39;localhost&#39; ]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Webserver grants.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>init_system</span>
      
      
        <span class='type'>(<tt>Enum[
    'sysv',
    'systemd',
    'upstart'
    ]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::init_system</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Default init system. Used to build service checks.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>service_program</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$monit::params::service_program</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the default init system program.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_check_ensure</span>
      
      
        <span class='type'>(<tt>Monit::Check::Ensure</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;present&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to create the system check.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_loadavg_1min</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>(</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>1 minute load average threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_loadavg_5min</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>(</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>5 minute load average threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_loadavg_15min</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>(</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>15 minute load average threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_cpu_user</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;75%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>CPU user usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_cpu_system</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;30%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>CPU system usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_cpu_wait</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;30%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>CPU wait usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_memory</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;75%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Memory usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_swap</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Swap usage threshold. NOTE: swap available since monit 5.2.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_fs</span>
      
      
        <span class='type'>(<tt>Variant[
    Array[Stdlib::Absolutepath],
    Array[Pattern['^/']]
    ]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to filesystems to check. If empty, will check all mounted filesystems,
but the ones with a type in $monit::fs_banned_types.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_fs_space_usage</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;80%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Filesystem space usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_fs_inode_usage</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;80%&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Filesystem inode usage threshold.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_cycles</span>
      
      
        <span class='type'>(<tt>Optional[Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Number of cycles before alerting.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>fs_banned_types</span>
      
      
        <span class='type'>(<tt>Array[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[&#39;devpts&#39;, &#39;devtmpfs&#39;, &#39;hugetlbfs&#39;, &#39;mqueue&#39;, &#39;nsfs&#39;, &#39;overlay&#39;, &#39;portal&#39;, &#39;rpc_pipefs&#39;, &#39;tmpfs&#39;]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>List of filesystem types to ignore in generation of $monit::system_fs.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>checks</span>
      
      
        <span class='type'>(<tt>Hash[String, Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Hash of additional checks to create.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>hiera_merge_strategy</span>
      
      
        <span class='type'>(<tt>Optional[Enum[
    'hiera_hash'
    ]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Merge strategy when obtaining checks from Hiera.
<strong>Deprecated</strong> use instead hiera 5 <a
href="https://puppet.com/docs/puppet/latest/hiera_merging.html">lookup_options</a>.</p>
</div>
      
    </li>
  
</ul>


</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/init.pp', line 106</span>

class monit(
  Boolean $service_enable                   = true,
  Enum[
    &#39;running&#39;,
    &#39;stopped&#39;
    ] $service_ensure                       = &#39;running&#39;,
  Stdlib::Absolutepath $conf_file           = $monit::params::conf_file,
  Stdlib::Absolutepath $conf_dir            = $monit::params::conf_dir,
  Boolean $conf_purge                       = true,
  Integer $check_interval                   = $monit::params::check_interval,
  Integer $check_start_delay                = $monit::params::check_start_delay,
  # $logfile can be an absolute path or
  # a string of the form &quot;syslog facility log_daemon&quot;
  Variant[
    Stdlib::Absolutepath,
    Pattern[&#39;^syslog( facility [_a-zA-Z0-9]+)?$&#39;]
    ] $logfile                              = $monit::params::logfile,
  Optional[Stdlib::Absolutepath] $idfile    = $monit::params::idfile,
  Optional[Stdlib::Absolutepath] $statefile = $monit::params::statefile,
  Boolean $eventqueue                       = $monit::params::eventqueue,
  Stdlib::Absolutepath $eventqueue_basedir  = &#39;/var/monit&#39;,
  Integer $eventqueue_slots                 = 100,
  Optional[Stdlib::Httpurl] $mmonit_url     = undef,
  Optional[String] $mailserver              = undef,
  String $mailformat_from                   = &quot;monit@${::fqdn}&quot;,
  # NOTE: reply-to available since monit 5.2
  Optional[String] $mailformat_replyto      = undef,
  Optional[String] $mailformat_subject      = undef,
  Optional[String] $mailformat_message      = undef,
  Array[String] $alerts                     = [],
  Boolean $httpserver                       = true,
  Integer[1024, 65535] $httpserver_port     = 2812,
  Optional[String] $httpserver_bind_address = undef,
  Boolean $httpserver_ssl                   = false,
  Optional[
    Stdlib::Absolutepath
    ] $httpserver_pemfile                   = undef,
  Array[String] $httpserver_allow           = [ &#39;localhost&#39; ],
  # Init system defaults.
  Enum[
    &#39;sysv&#39;,
    &#39;systemd&#39;,
    &#39;upstart&#39;
    ] $init_system                         = $monit::params::init_system,
  Stdlib::Absolutepath $service_program    = $monit::params::service_program,
  # System resources check.
  Monit::Check::Ensure $system_check_ensure = &#39;present&#39;,
  Numeric $system_loadavg_1min              = (3 * $::facts[&#39;processors&#39;][&#39;count&#39;]),
  Numeric $system_loadavg_5min              = (1.5 * $::facts[&#39;processors&#39;][&#39;count&#39;]),
  Numeric $system_loadavg_15min             = (1.5 * $::facts[&#39;processors&#39;][&#39;count&#39;]),
  String $system_cpu_user                   = &#39;75%&#39;,
  String $system_cpu_system                 = &#39;30%&#39;,
  String $system_cpu_wait                   = &#39;30%&#39;,
  String $system_memory                     = &#39;75%&#39;,
  # NOTE: swap available since monit 5.2.
  Optional[String] $system_swap             = undef,
  Variant[
    Array[Stdlib::Absolutepath],
    Array[Pattern[&#39;^/&#39;]]
    ] $system_fs                            = [],
  String $system_fs_space_usage             = &#39;80%&#39;,
  String $system_fs_inode_usage             = &#39;80%&#39;,
  Optional[Integer] $system_cycles          = undef,
  Array[String] $fs_banned_types            = [&#39;devpts&#39;, &#39;devtmpfs&#39;, &#39;hugetlbfs&#39;, &#39;mqueue&#39;, &#39;nsfs&#39;, &#39;overlay&#39;, &#39;portal&#39;, &#39;rpc_pipefs&#39;, &#39;tmpfs&#39;],
  # Additional checks.
  Hash[String, Hash] $checks                = {},
  Optional[Enum[
    &#39;hiera_hash&#39;
    ]] $hiera_merge_strategy                = undef,
) inherits monit::params {

  if !empty($hiera_merge_strategy) {
    warning(&#39;\$hiera_merge_strategy parameter is deprecated and will be removed in future versions! Please use Hiera 5 `lookup_options` instead. See https://puppet.com/docs/puppet/latest/hiera_merging.html&#39;)
  }
  class{&#39;monit::install&#39;: }
  -&gt; class{&#39;monit::config&#39;: }
  ~&gt; class{&#39;monit::service&#39;: }
  -&gt; Class[&#39;monit&#39;]

}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>